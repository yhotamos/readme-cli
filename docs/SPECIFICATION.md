# SPECIFICATION.md

## readtime-cli 機能仕様

### 1. 概要

`readtime-cli`は、与えられたテキストコンテンツ（ファイル、URL、標準入力）の推定読書時間を計算し、結果を標準出力に出力するコマンドラインツールです。

### 2. 入力ソース

以下の 3 種類の入力ソースをサポートします。

- **ローカルファイル**: コマンドライン引数としてファイルパスが指定された場合。
  例: `readtime path/to/article.md`
- **URL**: コマンドライン引数として有効な URL が指定された場合。
  例: `readtime https://example.com/blog/article`
  - URL からコンテンツを取得する際は、HTTP(S)リクエストを実行し、HTML コンテンツをパースして本文テキストを抽出します。
- **標準入力 (stdin)**: コマンドライン引数が指定されなかった場合、またはパイプでコンテンツが渡された場合。
  例: `cat article.txt | readtime`

### 3. 読書時間計算ロジック

読書時間は、テキスト内の単語数（または文字数）と、設定された 1 分あたりの単語数（WPM: Words Per Minute）に基づいて計算されます。

#### 3.1. 単語数（文字数）のカウント

- **英語**: スペースで区切られた単語をカウントします。句読点は単語の一部とはみなしません。
- **日本語**: 句読点を含まない文字数をカウントします。漢字、ひらがな、カタカナ、英数字を対象とします。

#### 3.2. デフォルト WPM

言語に応じて以下のデフォルト WPM を使用します。

- **英語 (en)**: 200 WPM
- **日本語 (ja)**: 500 文字/分

#### 3.3. 計算式

読書時間（分） = (単語数 または 文字数) / WPM

結果は最も近い整数に丸められます。1 分未満の場合は「1 分」と表示されます。

### 4. オプション

以下のオプションをサポートします。

- `--wpm <数値>`: 読書速度（WPM）をカスタム設定します。このオプションが指定された場合、デフォルト WPM は上書きされます。
  - 例: `readtime --wpm 250 path/to/article.md`
- `--lang <en|ja>`: テキストの言語を指定します。これにより、適切な単語カウントロジックとデフォルト WPM が適用されます。
  - 例: `readtime --lang ja path/to/japanese_article.txt`
  - 指定がない場合、ツールはコンテンツから言語を推測するか、デフォルトの言語（未定だが、実装時に決定）を使用します。

### 5. 出力フォーマット

計算された読書時間は、以下の形式で標準出力に出力されます。

- `推定読書時間: X分`
  - 例: `推定読書時間: 5分`

### 6. エラーハンドリング

- **ファイルが見つからない**: 指定されたファイルパスが存在しない場合、エラーメッセージを出力し、非ゼロの終了コードで終了します。
- **URL の取得失敗**: URL からのコンテンツ取得に失敗した場合（例: ネットワークエラー、404）、エラーメッセージを出力し、非ゼロの終了コードで終了します。
- **無効なオプション**: 未知のオプションや無効なオプション値が指定された場合、使用方法のヒントとともにエラーメッセージを出力し、非ゼロの終了コードで終了します。
- **コンテンツなし**: 入力ソースから有効なテキストコンテンツが抽出できなかった場合、エラーメッセージを出力し、非ゼロの終了コードで終了します。
